{"version":3,"sources":["../src/hooks/auth-header.before-request.hook.ts","../src/hooks/refresh-token.after-response.hook.ts","../src/create-data-provider.ts","../src/default.options.ts"],"sourcesContent":["import type { Hooks } from \"ky\";\n\ntype AuthHeaderBeforeRequestHookOptions = {\n  ACCESS_TOKEN_KEY: string;\n};\n\n/**\n * Gets the token from localStorage and adds `Bearer <token>` to the Authorization header.\n *\n * @param {string} options.ACCESS_TOKEN_KEY - The key used to retrieve the access token from localStorage.\n * @returns Ky beforeRequest hook function.\n * @example\n * ```ts\n * import { authHeaderBeforeRequestHook } from \"@refinedev/rest\";\n *\n * const dataProvider = createDataProvider(\"https://api.example.com\", {}, {\n *   hooks: {\n *     beforeRequest: [authHeaderBeforeRequestHook({ ACCESS_TOKEN_KEY: \"accessToken\" })],\n *   },\n * });\n * ```\n */\nexport const authHeaderBeforeRequestHook =\n  (\n    options: AuthHeaderBeforeRequestHookOptions,\n  ): NonNullable<Hooks[\"beforeRequest\"]>[number] =>\n  async (req) => {\n    const token = localStorage.getItem(options.ACCESS_TOKEN_KEY);\n\n    if (token) {\n      req.headers.set(\"Authorization\", `Bearer ${token}`);\n    }\n  };\n","import ky, { type Hooks } from \"ky\";\n\ntype RefreshTokenAfterResponseHookOptions = {\n  ACCESS_TOKEN_KEY: string;\n  REFRESH_TOKEN_KEY: string;\n  REFRESH_TOKEN_URL: string;\n};\n\n/**\n * Middleware to handle token refresh on 401 responses.\n *\n * @param {string} refineOptions.ACCESS_TOKEN_KEY - The key used to retrieve the access token from localStorage.\n * @param {string} refineOptions.REFRESH_TOKEN_KEY - The key used to retrieve the refresh token from localStorage.\n * @param {string} refineOptions.REFRESH_TOKEN_URL - The URL to send the refresh token request to.\n * @returns Ky afterResponse hook function.\n * @example\n * ```ts\n * import { refreshTokenAfterResponseHook } from \"@refinedev/rest\";\n *\n * const dataProvider = createDataProvider(\"https://api.example.com\", {}, {\n *   hooks: {\n *     afterResponse: [refreshTokenAfterResponseHook({\n *       ACCESS_TOKEN_KEY: \"accessToken\",\n *       REFRESH_TOKEN_KEY: \"refreshToken\",\n *       REFRESH_TOKEN_URL: \"https://api.example.com/refresh-token\",\n *     })],\n *   },\n * });\n * ```\n */\nexport const refreshTokenAfterResponseHook =\n  (\n    refineOptions: RefreshTokenAfterResponseHookOptions,\n  ): NonNullable<Hooks[\"afterResponse\"]>[number] =>\n  async (request, _options, response) => {\n    if (response.status === 401) {\n      const currentRefreshToken = localStorage.getItem(\n        refineOptions.REFRESH_TOKEN_KEY,\n      );\n\n      try {\n        const data = await ky<{ token: string; refreshToken: string }>(\n          refineOptions.REFRESH_TOKEN_URL,\n          {\n            method: \"post\",\n            body: JSON.stringify({ refreshToken: currentRefreshToken }),\n          },\n        ).json();\n\n        const accessToken = data.token;\n        const refreshToken = data.refreshToken;\n\n        localStorage.setItem(refineOptions.ACCESS_TOKEN_KEY, accessToken);\n        localStorage.setItem(refineOptions.REFRESH_TOKEN_KEY, refreshToken);\n\n        request.headers.set(\"Authorization\", `token ${accessToken}`);\n\n        return ky(request);\n      } catch (e) {\n        return response;\n      }\n    }\n\n    return response;\n  };\n","import type {\n  CreateManyResponse,\n  CreateResponse,\n  CustomResponse,\n  DataProvider,\n  DeleteOneResponse,\n  GetManyResponse,\n  GetOneResponse,\n  UpdateManyResponse,\n  UpdateResponse,\n} from \"@refinedev/core\";\nimport dm from \"deepmerge\";\nimport kyBase, { type Options as KyOptions } from \"ky\";\nimport qs from \"qs\";\n\nimport type { AnyObject, CreateDataProviderOptions } from \"./types\";\nimport { defaultCreateDataProviderOptions } from \"./default.options\";\n\ntype CreateDataProvider = {\n  kyInstance: typeof kyBase;\n  dataProvider: DataProvider;\n};\n\nexport const createDataProvider = (\n  apiURL: string,\n  baseOptions: CreateDataProviderOptions = defaultCreateDataProviderOptions,\n  kyOptions: KyOptions = {},\n): CreateDataProvider => {\n  const options = dm(defaultCreateDataProviderOptions, baseOptions);\n\n  const ky = kyBase.create({\n    prefixUrl: apiURL,\n    ...kyOptions,\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Accept: \"application/json\",\n      ...kyOptions.headers,\n    },\n    throwHttpErrors: false,\n  });\n\n  return {\n    kyInstance: ky,\n    dataProvider: {\n      getList: async (params) => {\n        const endpoint = options.getList.getEndpoint(params);\n\n        const headers = await options.getList.buildHeaders(params);\n\n        const query = await options.getList.buildQueryParams(params);\n\n        const response = await ky(endpoint, {\n          headers,\n          searchParams: qs.stringify(query, { encodeValuesOnly: true }),\n        });\n\n        const data = await options.getList.mapResponse(\n          response.clone(),\n          params,\n        );\n\n        const total = await options.getList.getTotalCount(\n          response.clone(),\n          params,\n        );\n\n        return { data, total };\n      },\n      getOne: async (params): Promise<GetOneResponse<any>> => {\n        const endpoint = options.getOne.getEndpoint(params);\n\n        const headers = await options.getOne.buildHeaders(params);\n\n        const query = await options.getOne.buildQueryParams(params);\n\n        const response = await ky(endpoint, {\n          headers,\n          searchParams: qs.stringify(query, { encodeValuesOnly: true }),\n        });\n\n        const data = await options.getOne.mapResponse(response, params);\n\n        return { data };\n      },\n      getMany: options.getMany\n        ? async (params): Promise<GetManyResponse<any>> => {\n            const endpoint =\n              options.getMany.getEndpoint?.(params) ?? params.resource;\n\n            const headers =\n              (await options.getMany.buildHeaders?.(params)) ?? {};\n\n            const query =\n              (await options.getMany.buildQueryParams?.(params)) ?? {};\n\n            const response = await ky(endpoint, {\n              headers,\n              searchParams: qs.stringify(query, { encodeValuesOnly: true }),\n            });\n\n            if (response.ok) {\n              const data = await options.getMany.mapResponse(response, params);\n\n              return { data };\n            }\n\n            let error;\n\n            if (options.getMany.transformError) {\n              error = await options.getMany.transformError(response, params);\n            } else {\n              error = await response.json();\n            }\n\n            throw error;\n          }\n        : undefined,\n      create: async (params): Promise<CreateResponse<any>> => {\n        const endpoint = options.create.getEndpoint(params);\n\n        const headers = await options.create.buildHeaders(params);\n\n        const query = await options.create.buildQueryParams(params);\n\n        const body = await options.create.buildBodyParams(params);\n\n        const response = await ky(endpoint, {\n          method: \"post\",\n          headers,\n          searchParams: qs.stringify(query, { encodeValuesOnly: true }),\n          body: JSON.stringify(body),\n        });\n\n        if (response.ok) {\n          const data = await options.create.mapResponse(response, params);\n\n          return { data };\n        }\n\n        const error = await options.create.transformError(response, params);\n\n        throw error;\n      },\n      createMany: options.createMany\n        ? async (params): Promise<CreateManyResponse<any>> => {\n            const endpoint =\n              options.createMany.getEndpoint?.(params) ?? params.resource;\n\n            const headers =\n              (await options.createMany.buildHeaders?.(params)) ?? {};\n\n            const query =\n              (await options.createMany.buildQueryParams?.(params)) ?? {};\n\n            const body = await options.createMany.buildBodyParams(params);\n\n            const response = await ky(endpoint, {\n              method: \"post\",\n              headers,\n              searchParams: qs.stringify(query, { encodeValuesOnly: true }),\n              body: JSON.stringify(body),\n            });\n\n            if (response.ok) {\n              const data = await options.createMany.mapResponse(\n                response,\n                params,\n              );\n\n              return { data };\n            }\n\n            let error;\n\n            if (options.createMany.transformError) {\n              error = await options.createMany?.transformError(\n                response,\n                params,\n              );\n            } else {\n              error = await response.json();\n            }\n\n            throw error;\n          }\n        : undefined,\n      update: async (params): Promise<UpdateResponse<any>> => {\n        const endpoint = options.update.getEndpoint(params);\n\n        // TODO: Validate method name.\n        const method = options.update.getRequestMethod(params);\n\n        const headers = await options.update.buildHeaders(params);\n\n        const query = await options.update.buildQueryParams(params);\n\n        const body = await options.update.buildBodyParams(params);\n\n        const response = await ky(endpoint, {\n          method,\n          headers,\n          searchParams: qs.stringify(query, { encodeValuesOnly: true }),\n          body: JSON.stringify(body),\n        });\n\n        if (response.ok) {\n          const data = await options.update.mapResponse(response, params);\n\n          return { data };\n        }\n\n        const error = await options.update.transformError(response, params);\n\n        throw error;\n      },\n      updateMany: options.updateMany\n        ? async (params): Promise<UpdateManyResponse<any>> => {\n            const endpoint = options.updateMany.getEndpoint(params);\n\n            const method =\n              options.updateMany.getRequestMethod?.(params) ?? \"patch\";\n\n            const headers =\n              (await options.updateMany.buildHeaders?.(params)) ?? {};\n\n            const query =\n              (await options.updateMany.buildQueryParams?.(params)) ?? {};\n\n            const body = await options.updateMany.buildBodyParams(params);\n\n            const response = await ky(endpoint, {\n              method,\n              headers,\n              searchParams: qs.stringify(query, { encodeValuesOnly: true }),\n              body: JSON.stringify(body),\n            });\n\n            if (response.ok) {\n              const data = await options.updateMany.mapResponse(\n                response,\n                params,\n              );\n\n              return { data };\n            }\n\n            let error;\n\n            if (options.updateMany.transformError) {\n              error = await options.updateMany.transformError(response, params);\n            } else {\n              error = await response.json();\n            }\n\n            throw error;\n          }\n        : undefined,\n      deleteOne: async (params): Promise<DeleteOneResponse<any>> => {\n        const endpoint = options.deleteOne.getEndpoint(params);\n\n        const headers = await options.deleteOne.buildHeaders(params);\n\n        const query = await options.deleteOne.buildQueryParams(params);\n\n        const response = await ky(endpoint, {\n          method: \"delete\",\n          headers,\n          searchParams: qs.stringify(query, { encodeValuesOnly: true }),\n        });\n\n        if (response.ok) {\n          const data = await options.deleteOne.mapResponse(response, params);\n\n          return { data };\n        }\n\n        const error = await options.deleteOne.transformError(response, params);\n\n        throw error;\n      },\n      deleteMany: options.deleteMany\n        ? async (params): Promise<DeleteOneResponse<any>> => {\n            const endpoint =\n              options.deleteMany.getEndpoint?.(params) ?? params.resource;\n\n            const headers =\n              (await options.deleteMany.buildHeaders?.(params)) ?? {};\n\n            const query =\n              (await options.deleteMany.buildQueryParams?.(params)) ?? {};\n\n            const response = await ky(endpoint, {\n              method: \"delete\",\n              headers,\n              searchParams: qs.stringify(query, { encodeValuesOnly: true }),\n            });\n\n            if (options.deleteMany.mapResponse) {\n              const data = await options.deleteMany.mapResponse(\n                response,\n                params,\n              );\n\n              return { data };\n            }\n\n            return { data: undefined };\n          }\n        : undefined,\n      custom: async (params): Promise<CustomResponse<any>> => {\n        const { method, url } = params;\n\n        let client = kyBase.create({\n          method,\n          ...kyOptions,\n        });\n\n        const headers = await options.custom.buildHeaders(params);\n        if (headers) {\n          client = client.extend({ headers });\n        }\n\n        const query = await options.custom.buildQueryParams(params);\n        if (query) {\n          client = client.extend({\n            searchParams: qs.stringify(query, { encodeValuesOnly: true }),\n          });\n        }\n\n        if ([\"post\", \"put\", \"patch\"].includes(method)) {\n          const body = await options.custom.buildBodyParams(params);\n\n          if (body) {\n            client = client.extend({ body: JSON.stringify(body) });\n          }\n        }\n\n        const response = await client<AnyObject>(url);\n\n        if (response.ok) {\n          const data = await options.custom.mapResponse(response, params);\n\n          return { data };\n        }\n\n        const error = await options.custom.transformError(response, params);\n\n        throw error;\n      },\n      getApiUrl: () => apiURL,\n    },\n  };\n};\n","import type {\n  CreateParams,\n  CustomParams,\n  DeleteOneParams,\n  GetListParams,\n  GetOneParams,\n  UpdateParams,\n  HttpError,\n} from \"@refinedev/core\";\nimport type { KyResponse } from \"ky\";\n\nimport type { AnyObject } from \"./types\";\n\nexport const defaultCreateDataProviderOptions = {\n  getList: {\n    getEndpoint(params: GetListParams): string {\n      return `${params.resource}`;\n    },\n    async buildHeaders(params: GetListParams) {\n      return params.meta?.headers ?? {};\n    },\n    async buildQueryParams(params: GetListParams) {\n      const { filters, sorters, pagination } = params;\n\n      const queryParams = {\n        filters,\n        sorters,\n        pagination,\n        ...params.meta?.query,\n      };\n\n      // filters[0][field]=id&filters[0][operator]=eq&filters[0][value]=123\n\n      return queryParams;\n    },\n    async mapResponse(\n      response: KyResponse<AnyObject>,\n      _params: GetListParams,\n    ): Promise<any[]> {\n      return await response.json();\n    },\n    async getTotalCount(\n      _response: KyResponse<AnyObject>,\n      _params: GetListParams,\n    ): Promise<number> {\n      return -1;\n    },\n  },\n  getOne: {\n    getEndpoint(params: GetOneParams) {\n      return `${params.resource}/${params.id}`;\n    },\n    async buildHeaders(params: GetOneParams) {\n      return params.meta?.headers ?? {};\n    },\n    async buildQueryParams(params: GetOneParams) {\n      return params.meta?.query ?? {};\n    },\n    async mapResponse(\n      response: KyResponse<AnyObject>,\n      _params: GetOneParams,\n    ): Promise<Record<string, any>> {\n      return await response.json();\n    },\n  },\n  create: {\n    getEndpoint(params: CreateParams<any>): string {\n      return params.resource;\n    },\n    async buildHeaders(params: CreateParams<any>) {\n      return params.meta?.headers ?? {};\n    },\n    async buildQueryParams(params: CreateParams<any>) {\n      return params.meta?.query ?? {};\n    },\n    async buildBodyParams(params: CreateParams<any>) {\n      return params.variables;\n    },\n    async mapResponse(\n      response: KyResponse<AnyObject>,\n      _params: CreateParams<any>,\n    ): Promise<Record<string, any>> {\n      return await response.json();\n    },\n    async transformError(\n      response: KyResponse<AnyObject>,\n      params: CreateParams<any>,\n    ): Promise<HttpError> {\n      const body = await response.json();\n\n      return {\n        message: JSON.stringify({ ...body, variables: params.variables }),\n        statusCode: response.status,\n      };\n    },\n  },\n  update: {\n    getEndpoint(params: UpdateParams<any>): string {\n      return `${params.resource}/${params.id}`;\n    },\n    getRequestMethod(params: UpdateParams<any>) {\n      return params.meta?.method ?? \"patch\";\n    },\n    async buildHeaders(params: UpdateParams<any>) {\n      return params.meta?.headers ?? {};\n    },\n    async buildQueryParams(params: UpdateParams<any>) {\n      return params.meta?.query ?? {};\n    },\n    async buildBodyParams(params: UpdateParams<any>) {\n      return params.variables;\n    },\n    async mapResponse(\n      response: KyResponse<AnyObject>,\n      _params: UpdateParams<any>,\n    ) {\n      return await response.json();\n    },\n\n    async transformError(\n      response: KyResponse<AnyObject>,\n      params: UpdateParams<any>,\n    ): Promise<HttpError> {\n      const body = await response.json();\n\n      return {\n        message: JSON.stringify({\n          ...body,\n          id: params.id,\n          variables: params.variables,\n        }),\n        statusCode: response.status,\n      };\n    },\n  },\n  deleteOne: {\n    getEndpoint(params: DeleteOneParams<any>) {\n      return `${params.resource}/${params.id}`;\n    },\n    async buildHeaders(params: DeleteOneParams<any>) {\n      return params.meta?.headers ?? {};\n    },\n    async buildQueryParams(params: DeleteOneParams<any>) {\n      return params.meta?.query ?? {};\n    },\n    async mapResponse(\n      _response: KyResponse<AnyObject>,\n      _params: DeleteOneParams<any>,\n    ) {\n      return undefined;\n    },\n    async transformError(\n      response: KyResponse<AnyObject>,\n      params: DeleteOneParams<any>,\n    ) {\n      const body = await response.json();\n\n      return {\n        message: JSON.stringify({\n          ...body,\n          id: params.id,\n        }),\n        statusCode: response.status,\n      };\n    },\n  },\n  custom: {\n    async buildQueryParams(params: CustomParams<any>) {\n      return params.query ?? {};\n    },\n    async buildHeaders(params: CustomParams<any>) {\n      return params.headers ?? {};\n    },\n    async buildBodyParams(params: CustomParams<any>) {\n      return params.payload ?? {};\n    },\n    async mapResponse(\n      response: KyResponse<AnyObject | AnyObject[]>,\n      _params: CustomParams<any>,\n    ) {\n      return await response.json();\n    },\n    async transformError(\n      response: KyResponse<AnyObject>,\n      params: CustomParams<any>,\n    ) {\n      const body = await response.json();\n\n      return {\n        message: JSON.stringify({\n          ...body,\n          params,\n        }),\n        statusCode: response.status,\n      };\n    },\n  },\n};\n"],"mappings":"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","names":["ky"]}